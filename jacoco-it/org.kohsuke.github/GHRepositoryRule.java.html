<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang=""><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>GHRepositoryRule.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">GitHub API for Java</a> &gt; <a href="index.source.html" class="el_package">org.kohsuke.github</a> &gt; <span class="el_source">GHRepositoryRule.java</span></div><h1>GHRepositoryRule.java</h1><pre class="source lang-java linenums">package org.kohsuke.github;

import com.fasterxml.jackson.core.type.TypeReference;
import com.fasterxml.jackson.databind.JsonNode;
import edu.umd.cs.findbugs.annotations.SuppressFBWarnings;
import org.kohsuke.github.internal.EnumUtils;

import java.io.IOException;
import java.util.List;
import java.util.Map;
import java.util.Optional;

/**
 * Represents a repository rule.
 */
@SuppressFBWarnings(value = { &quot;UWF_UNWRITTEN_PUBLIC_OR_PROTECTED_FIELD&quot;, &quot;UWF_UNWRITTEN_FIELD&quot;, &quot;NP_UNWRITTEN_FIELD&quot; },
        justification = &quot;JSON API&quot;)
public class GHRepositoryRule extends GitHubInteractiveObject {

    /**
     * Alerts threshold parameter.
     */
<span class="fc" id="L23">    public static enum AlertsThreshold {</span>
        /**
         * all
         */
<span class="fc" id="L27">        ALL,</span>

        /**
         * errors
         */
<span class="fc" id="L32">        ERRORS,</span>

        /**
         * errors_and_warnings
         */
<span class="fc" id="L37">        ERRORS_AND_WARNINGS,</span>

        /**
         * none
         */
<span class="fc" id="L42">        NONE</span>
    }

    /**
     * Boolean parameter for a ruleset.
     */
    public static class BooleanParameter extends Parameter&lt;Boolean&gt; {
        /**
         * Instantiates a new boolean parameter.
         *
         * @param key
         *            the key
         */
        public BooleanParameter(String key) {
<span class="fc" id="L56">            super(key);</span>
<span class="fc" id="L57">        }</span>

        @Override
        TypeReference&lt;Boolean&gt; getType() {
<span class="fc" id="L61">            return new TypeReference&lt;Boolean&gt;() {</span>
            };
        }
    }
    /**
     * Code scanning tool parameter.
     */
    public static class CodeScanningTool {

        private AlertsThreshold alertsThreshold;

        private SecurityAlertsThreshold securityAlertsThreshold;
        private String tool;
        /**
         * Create default CodeScanningTool instance
         */
<span class="fc" id="L77">        public CodeScanningTool() {</span>
<span class="fc" id="L78">        }</span>

        /**
         * Gets the alerts threshold.
         *
         * @return the alerts threshold
         */
        public AlertsThreshold getAlertsThreshold() {
<span class="fc" id="L86">            return this.alertsThreshold;</span>
        }

        /**
         * Gets the security alerts threshold.
         *
         * @return the security alerts threshold
         */
        public SecurityAlertsThreshold getSecurityAlertsThreshold() {
<span class="fc" id="L95">            return this.securityAlertsThreshold;</span>
        }

        /**
         * Gets the tool.
         *
         * @return the tool
         */
        public String getTool() {
<span class="fc" id="L104">            return this.tool;</span>
        }
    }
    /**
     * Integer parameter for a ruleset.
     */
    public static class IntegerParameter extends Parameter&lt;Integer&gt; {
        /**
         * Instantiates a new integer parameter.
         *
         * @param key
         *            the key
         */
        public IntegerParameter(String key) {
<span class="fc" id="L118">            super(key);</span>
<span class="fc" id="L119">        }</span>

        @Override
        TypeReference&lt;Integer&gt; getType() {
<span class="fc" id="L123">            return new TypeReference&lt;Integer&gt;() {</span>
            };
        }
    }
    /**
     * List parameter for a ruleset.
     *
     * @param &lt;T&gt;
     *            the type of the list
     */
    public abstract static class ListParameter&lt;T&gt; extends Parameter&lt;List&lt;T&gt;&gt; {
        /**
         * Instantiates a new list parameter.
         *
         * @param key
         *            the key
         */
        public ListParameter(String key) {
<span class="fc" id="L141">            super(key);</span>
<span class="fc" id="L142">        }</span>
    }
    /**
     * Operator parameter.
     */
<span class="fc" id="L147">    public static enum Operator {</span>
        /**
         * contains
         */
<span class="fc" id="L151">        CONTAINS,</span>

        /**
         * ends_with
         */
<span class="fc" id="L156">        ENDS_WITH,</span>

        /**
         * regex
         */
<span class="fc" id="L161">        REGEX,</span>

        /**
         * starts_with
         */
<span class="fc" id="L166">        STARTS_WITH</span>
    }

    /**
     * Basic parameter for a ruleset.
     *
     * @param &lt;T&gt;
     *            the type of the parameter
     */
    public abstract static class Parameter&lt;T&gt; {

        private final String key;

        /**
         * Instantiates a new parameter.
         *
         * @param key
         *            the key
         */
<span class="fc" id="L185">        protected Parameter(String key) {</span>
<span class="fc" id="L186">            this.key = key;</span>
<span class="fc" id="L187">        }</span>

        T apply(JsonNode jsonNode, GitHub root) throws IOException {
<span class="fc bfc" id="L190" title="All 2 branches covered.">            if (jsonNode == null) {</span>
<span class="fc" id="L191">                return null;</span>
            }
<span class="fc" id="L193">            return GitHubClient.getMappingObjectReader(root).forType(this.getType()).readValue(jsonNode);</span>
        }

        /**
         * Gets the key.
         *
         * @return the key
         */
        String getKey() {
<span class="fc" id="L202">            return this.key;</span>
        }

        /**
         * Get the parameter type reference for type mapping.
         */
        abstract TypeReference&lt;T&gt; getType();
    }

    /**
     * Available parameters for a ruleset.
     */
    public interface Parameters {
        /**
         * code_scanning_tools parameter
         */
<span class="fc" id="L218">        public static final ListParameter&lt;CodeScanningTool&gt; CODE_SCANNING_TOOLS = new ListParameter&lt;CodeScanningTool&gt;(</span>
<span class="fc" id="L219">                &quot;code_scanning_tools&quot;) {</span>
            @Override
            TypeReference&lt;List&lt;CodeScanningTool&gt;&gt; getType() {
<span class="fc" id="L222">                return new TypeReference&lt;List&lt;CodeScanningTool&gt;&gt;() {</span>
                };
            }
        };
        /**
         * dismiss_stale_reviews_on_push parameter
         */
<span class="fc" id="L229">        public static final BooleanParameter DISMISS_STALE_REVIEWS_ON_PUSH = new BooleanParameter(</span>
                &quot;dismiss_stale_reviews_on_push&quot;);
        /**
         * name parameter
         */
<span class="fc" id="L234">        public static final StringParameter NAME = new StringParameter(&quot;name&quot;);</span>
        /**
         * negate parameter
         */
<span class="fc" id="L238">        public static final BooleanParameter NEGATE = new BooleanParameter(&quot;negate&quot;);</span>
        /**
         * operator parameter
         */
<span class="fc" id="L242">        public static final Parameter&lt;Operator&gt; OPERATOR = new Parameter&lt;Operator&gt;(&quot;operator&quot;) {</span>
            @Override
            TypeReference&lt;Operator&gt; getType() {
<span class="fc" id="L245">                return new TypeReference&lt;Operator&gt;() {</span>
                };
            }
        };
        /**
         * regex parameter
         */
<span class="fc" id="L252">        public static final StringParameter REGEX = new StringParameter(&quot;regex&quot;);</span>
        /**
         * required_approving_review_count parameter
         */
<span class="fc" id="L256">        public static final IntegerParameter REQUIRED_APPROVING_REVIEW_COUNT = new IntegerParameter(</span>
                &quot;required_approving_review_count&quot;);
        /**
         * required_deployment_environments parameter
         */
<span class="fc" id="L261">        public static final ListParameter&lt;String&gt; REQUIRED_DEPLOYMENT_ENVIRONMENTS = new ListParameter&lt;String&gt;(</span>
<span class="fc" id="L262">                &quot;required_deployment_environments&quot;) {</span>
            @Override
            TypeReference&lt;List&lt;String&gt;&gt; getType() {
<span class="fc" id="L265">                return new TypeReference&lt;List&lt;String&gt;&gt;() {</span>
                };
            }
        };
        /**
         * required_review_thread_resolution parameter
         */
<span class="fc" id="L272">        public static final BooleanParameter REQUIRED_REVIEW_THREAD_RESOLUTION = new BooleanParameter(</span>
                &quot;required_review_thread_resolution&quot;);
        /**
         * required_status_checks parameter
         */
<span class="fc" id="L277">        public static final ListParameter&lt;StatusCheckConfiguration&gt; REQUIRED_STATUS_CHECKS = new ListParameter&lt;StatusCheckConfiguration&gt;(</span>
<span class="fc" id="L278">                &quot;required_status_checks&quot;) {</span>
            @Override
            TypeReference&lt;List&lt;StatusCheckConfiguration&gt;&gt; getType() {
<span class="fc" id="L281">                return new TypeReference&lt;List&lt;StatusCheckConfiguration&gt;&gt;() {</span>
                };
            }
        };
        /**
         * require_code_owner_review parameter
         */
<span class="fc" id="L288">        public static final BooleanParameter REQUIRE_CODE_OWNER_REVIEW = new BooleanParameter(</span>
                &quot;require_code_owner_review&quot;);
        /**
         * require_last_push_approval parameter
         */
<span class="fc" id="L293">        public static final BooleanParameter REQUIRE_LAST_PUSH_APPROVAL = new BooleanParameter(</span>
                &quot;require_last_push_approval&quot;);
        /**
         * strict_required_status_checks_policy parameter
         */
<span class="fc" id="L298">        public static final BooleanParameter STRICT_REQUIRED_STATUS_CHECKS_POLICY = new BooleanParameter(</span>
                &quot;strict_required_status_checks_policy&quot;);
        /**
         * update_allows_fetch_and_merge parameter
         */
<span class="fc" id="L303">        public static final BooleanParameter UPDATE_ALLOWS_FETCH_AND_MERGE = new BooleanParameter(</span>
                &quot;update_allows_fetch_and_merge&quot;);
        /**
         * workflows parameter
         */
<span class="fc" id="L308">        public static final ListParameter&lt;WorkflowFileReference&gt; WORKFLOWS = new ListParameter&lt;WorkflowFileReference&gt;(</span>
<span class="fc" id="L309">                &quot;workflows&quot;) {</span>
            @Override
            TypeReference&lt;List&lt;WorkflowFileReference&gt;&gt; getType() {
<span class="fc" id="L312">                return new TypeReference&lt;List&lt;WorkflowFileReference&gt;&gt;() {</span>
                };
            }
        };
    }

    /**
     * The source of the ruleset type.
     */
<span class="fc" id="L321">    public enum RulesetSourceType {</span>
        /**
         * Organization
         */
<span class="fc" id="L325">        ORGANIZATION,</span>

        /**
         * Repository
         */
<span class="fc" id="L330">        REPOSITORY,</span>

        /**
         * unknown
         */
<span class="fc" id="L335">        UNKNOWN</span>
    }

    /**
     * Security alerts threshold parameter.
     */
<span class="fc" id="L341">    public static enum SecurityAlertsThreshold {</span>
        /**
         * all
         */
<span class="fc" id="L345">        ALL,</span>

        /**
         * critical
         */
<span class="fc" id="L350">        CRITICAL,</span>

        /**
         * high_or_higher
         */
<span class="fc" id="L355">        HIGH_OR_HIGHER,</span>

        /**
         * medium_or_higher
         */
<span class="fc" id="L360">        MEDIUM_OR_HIGHER,</span>

        /**
         * none
         */
<span class="fc" id="L365">        NONE</span>
    }

    /**
     * Status check configuration parameter.
     */
    public static class StatusCheckConfiguration {

        private String context;

        private Integer integrationId;
        /**
         * Create default StatusCheckConfiguration instance
         */
<span class="fc" id="L379">        public StatusCheckConfiguration() {</span>
<span class="fc" id="L380">        }</span>

        /**
         * Gets the context.
         *
         * @return the context
         */
        public String getContext() {
<span class="fc" id="L388">            return this.context;</span>
        }

        /**
         * Gets the integration id.
         *
         * @return the integration id
         */
        public Integer getIntegrationId() {
<span class="fc" id="L397">            return this.integrationId;</span>
        }
    }

    /**
     * String parameter for a ruleset.
     */
    public static class StringParameter extends Parameter&lt;String&gt; {
        /**
         * Instantiates a new string parameter.
         *
         * @param key
         *            the key
         */
        public StringParameter(String key) {
<span class="fc" id="L412">            super(key);</span>
<span class="fc" id="L413">        }</span>

        @Override
        TypeReference&lt;String&gt; getType() {
<span class="fc" id="L417">            return new TypeReference&lt;String&gt;() {</span>
            };
        }
    }

    /**
     * The type of the ruleset.
     */
<span class="fc" id="L425">    public static enum Type {</span>
        /**
         * branch_name_pattern
         */
<span class="fc" id="L429">        BRANCH_NAME_PATTERN,</span>

        /**
         * code_scanning
         */
<span class="fc" id="L434">        CODE_SCANNING,</span>

        /**
         * committer_email_pattern
         */
<span class="fc" id="L439">        COMMITTER_EMAIL_PATTERN,</span>

        /**
         * commit_author_email_pattern
         */
<span class="fc" id="L444">        COMMIT_AUTHOR_EMAIL_PATTERN,</span>

        /**
         * commit_message_pattern
         */
<span class="fc" id="L449">        COMMIT_MESSAGE_PATTERN,</span>

        /**
         * creation
         */
<span class="fc" id="L454">        CREATION,</span>

        /**
         * deletion
         */
<span class="fc" id="L459">        DELETION,</span>

        /**
         * non_fast_forward
         */
<span class="fc" id="L464">        NON_FAST_FORWARD,</span>

        /**
         * pull_request
         */
<span class="fc" id="L469">        PULL_REQUEST,</span>

        /**
         * required_deployments
         */
<span class="fc" id="L474">        REQUIRED_DEPLOYMENTS,</span>

        /**
         * required_linear_history
         */
<span class="fc" id="L479">        REQUIRED_LINEAR_HISTORY,</span>

        /**
         * required_signatures
         */
<span class="fc" id="L484">        REQUIRED_SIGNATURES,</span>

        /**
         * required_status_checks
         */
<span class="fc" id="L489">        REQUIRED_STATUS_CHECKS,</span>

        /**
         * tag_name_pattern
         */
<span class="fc" id="L494">        TAG_NAME_PATTERN,</span>

        /**
         * unknown
         */
<span class="fc" id="L499">        UNKNOWN,</span>

        /**
         * update
         */
<span class="fc" id="L504">        UPDATE,</span>

        /**
         * workflows
         */
<span class="fc" id="L509">        WORKFLOWS</span>
    }

    /**
     * Workflow file reference parameter.
     */
    public static class WorkflowFileReference {

        private String path;

        private String ref;
        private long repositoryId;
        private String sha;
        /**
         * Create default WorkflowFileReference instance
         */
<span class="fc" id="L525">        public WorkflowFileReference() {</span>
<span class="fc" id="L526">        }</span>

        /**
         * Gets the path.
         *
         * @return the path
         */
        public String getPath() {
<span class="fc" id="L534">            return this.path;</span>
        }

        /**
         * Gets the ref.
         *
         * @return the ref
         */
        public String getRef() {
<span class="fc" id="L543">            return this.ref;</span>
        }

        /**
         * Gets the repository id.
         *
         * @return the repository id
         */
        public long getRepositoryId() {
<span class="fc" id="L552">            return this.repositoryId;</span>
        }

        /**
         * Gets the sha.
         *
         * @return the sha
         */
        public String getSha() {
<span class="fc" id="L561">            return this.sha;</span>
        }
    }

    private Map&lt;String, JsonNode&gt; parameters;

    private long rulesetId;

    private String rulesetSource;

    private String rulesetSourceType;

    private String type;

    /**
     * Create default GHRepositoryRule instance
     */
<span class="fc" id="L578">    public GHRepositoryRule() {</span>
<span class="fc" id="L579">    }</span>

    /**
     * Gets a parameter. ({@link GHRepositoryRule.Parameters Parameters} provides a list of available parameters.)
     *
     * @param parameter
     *            the parameter
     * @param &lt;T&gt;
     *            the type of the parameter
     * @return the parameters
     * @throws IOException
     *             if an I/O error occurs
     */
    public &lt;T&gt; Optional&lt;T&gt; getParameter(Parameter&lt;T&gt; parameter) throws IOException {
<span class="pc bpc" id="L593" title="1 of 2 branches missed.">        if (this.parameters == null) {</span>
<span class="nc" id="L594">            return Optional.empty();</span>
        }
<span class="fc" id="L596">        JsonNode jsonNode = this.parameters.get(parameter.getKey());</span>
<span class="fc bfc" id="L597" title="All 2 branches covered.">        if (jsonNode == null) {</span>
<span class="fc" id="L598">            return Optional.empty();</span>
        }
<span class="fc" id="L600">        return Optional.ofNullable(parameter.apply(jsonNode, root()));</span>
    }

    /**
     * Gets the ruleset id.
     *
     * @return the ruleset id
     */
    public long getRulesetId() {
<span class="fc" id="L609">        return this.rulesetId;</span>
    }

    /**
     * Gets the ruleset source.
     *
     * @return the ruleset source
     */
    public String getRulesetSource() {
<span class="fc" id="L618">        return this.rulesetSource;</span>
    }

    /**
     * Gets the ruleset source type.
     *
     * @return the ruleset source type
     */
    public RulesetSourceType getRulesetSourceType() {
<span class="fc" id="L627">        return EnumUtils.getEnumOrDefault(RulesetSourceType.class, this.rulesetSourceType, RulesetSourceType.UNKNOWN);</span>
    }

    /**
     * Gets the type.
     *
     * @return the type
     */
    public Type getType() {
<span class="fc" id="L636">        return EnumUtils.getEnumOrDefault(Type.class, this.type, Type.UNKNOWN);</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.12.202403310830</span></div></body></html>